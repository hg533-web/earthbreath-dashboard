# 改进实现方案

## 🎯 两个改进方向

### 1. 基于历史数据的预测算法
- ✅ 从AirNow API获取过去30-90天的历史数据
- ✅ 分析趋势和周期性模式
- ✅ 基于历史数据预测未来

### 2. 个性化risk_score计算
- ✅ 考虑用户问卷内容
- ✅ 根据用户哮喘严重程度调整风险
- ✅ 考虑用户触发因素的敏感性

## 📝 实现细节

### 方向1: 历史数据预测

**优势**:
- 基于真实历史数据，更准确
- 可以检测季节性趋势
- 可以考虑周期性模式（工作日vs周末）

**方法**:
1. 收集过去30天历史数据
2. 分析趋势（线性回归）
3. 检测季节性（周/月模式）
4. 预测未来值 = 当前值 + 趋势 + 季节性调整

### 方向2: 个性化risk_score

**考虑的用户因素**:
1. **哮喘严重程度** (asthma_severity)
   - mild: 风险 × 0.8 (降低20%)
   - moderate: 风险 × 1.0 (不调整)
   - severe: 风险 × 1.5 (增加50%)

2. **哮喘控制水平** (asthma_control)
   - well-controlled: × 0.9
   - partially-controlled: × 1.1
   - poorly-controlled: × 1.3

3. **症状频率** (symptom_frequency)
   - daily: × 1.4
   - weekly: × 1.2
   - monthly: × 1.0
   - rarely: × 0.9

4. **触发因素** (trigger_factors)
   - 如果当前环境条件触发用户敏感因素，增加风险
   - 例如：pollen触发 + 高花粉计数 = 风险增加

## 🔄 集成方案

1. **修改travel_recommendation生成函数**
   - 集成预测服务
   - 集成个性化风险计算

2. **修改API端点**
   - 支持用户ID参数
   - 返回个性化risk_score

3. **前端更新**
   - 传递用户信息到API
   - 显示个性化建议

## ⚠️ 注意事项

- 历史数据收集需要时间（可能需要几天才能有足够数据）
- 预测准确性取决于历史数据质量
- 个性化需要用户登录

